import{f as i,t as e,b as t,p as s,l,n as r,d as o,i as a,h as n,B as d,q as c,S as f,r as p}from"./index-60ffdcbe.js";import{C as v}from"./index-d49f25e3.js";import{C as m,T as x}from"./index-08d30a70.js";import{L as u}from"./leaflet-e23c1952.js";import{C as g}from"./index-8c8ceb60.js";import{D as h}from"./input-f3b5d24c.js";import{h as b}from"./moment-0b360bb8.js";import"./Chip-fe5cdcaa.js";import"./Divider-65d22fcf.js";import{c as S,a as C}from"./index.module-8c68dbae.js";import"./Typography-63ca3400.js";import"./index-d93c6e67.js";import"./Visibility-f62f166e.js";import"./CircularProgress-6afa790f.js";import"./formControlState-865d6002.js";import"./FormControl-d7e9850b.js";import"./FormLabel-f195491a.js";import"./isHostComponent-28f2e306.js";const y=e('<svg><path d="M0 0h24v24H0z" fill="none"></svg>',!1,!0),w=e('<svg><path d="M18 8c0-3.31-2.69-6-6-6S6 4.69 6 8c0 4.5 6 11 6 11s6-6.5 6-11zm-8 0c0-1.1.9-2 2-2s2 .9 2 2-.89 2-2 2c-1.1 0-2-.9-2-2zM5 20v2h14v-2H5z"></svg>',!1,!0),j=i((()=>[y(),w()]),"PinDrop"),I=e('<div class="grid gap-2 relative text-[14px] overflow-auto"><div class="flex gap-2"><div class="font-bold">MSIDN</div><div></div></div><div class="flex gap-2"><div class="font-bold">ALAMAT</div><div></div></div><div class="flex gap-2"><div class="font-bold">DEVICE:</div><div></div></div><div class="flex gap-2"><div class="font-bold">PROVIDER:</div><div></div></div><div class="flex gap-2"><div class="font-bold">IMEI:</div><div></div></div><div class="flex gap-2"><div class="font-bold">IMSI:</div><div></div></div><div class="flex gap-2 cursor-pointer"><div class="font-bold">MAPS:</div><div class=" text-blue-400">'),M=e('<form class="col-span-3 border-r-2 pr-4 border-primarry-2 flex flex-1 flex-col"><div class="relative flex flex-col flex-1"><div class="flex flex-col relative flex-1"><div class="px-4 space-y-4 absolute w-full h-full left-0 top-0 overflow-auto">'),P=e('<div class="flex-1"><div class="w-full h-full"><div class="w-full h-full">'),k=e('<div class="flex flex-col flex-1 col-span-6">'),D=e('<div class="flex flex-1 flex-col py-4">'),O=e('<div><div class="flex justify-between items-center border pr-2 border-primarry-2"><div class="flex gap-2"></div><div> ');let T;new Array(10).fill("");const E=()=>{let i=new(u.Icon.extend({options:{iconSize:[48,48],iconAnchor:[15,0],popupAnchor:[0,-0]}}))({iconUrl:"./assets/marker.png"});const[e,c]=t(null);let y;s((()=>{return i=y,T=u.map(i).setView([-6.2,106.816666],7),void u.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",{attribution:""}).addTo(T);var i}));const w=S({search:C("",{required:!0})}),[E,L]=t(!1),N=(i,e)=>{function t(){window.api.invoke("new_browser",e.maps)}return(()=>{const s=I(),l=s.firstChild,r=l.firstChild.nextSibling,o=l.nextSibling,n=o.firstChild.nextSibling,d=o.nextSibling,c=d.firstChild.nextSibling,f=d.nextSibling,p=f.firstChild.nextSibling,v=f.nextSibling,m=v.firstChild.nextSibling,x=v.nextSibling,u=x.firstChild.nextSibling,g=x.nextSibling,h=g.firstChild.nextSibling;return a(r,i),a(n,(()=>e.address)),a(c,(()=>e.device)),a(p,(()=>e.provider)),a(m,(()=>e.imei)),a(u,(()=>e.imsi)),g.$$click=t,a(h,(()=>e.maps)),s})()},A=async e=>{e.preventDefault();let{search:t}=w.value,s={keyword:t};L(!0);try{const e=await r().post("/checkpos/search",s);let t=e.data.data.keyword,l=e.data.data.response[0];u.marker([l.lat,l.long],{icon:i}).addTo(T).bindPopup(N(t,l)).openPopup(),f.fire({icon:"success",title:"SUCCESS",text:e.data.message,didClose:()=>{L(!1),w.controls.search.setValue("")}})}catch(l){/^62\d{10,15}$/.test(t)?f.fire({icon:"error",title:"OOPS",text:"Number not found or switch off"}):f.fire({icon:"error",title:"OOPS",text:"Invalid MSISDN. Please use the Indonesian country code (e.g., 6287654321)."}),L(!1)}};l((()=>{r().get("/checkpos/search").then((i=>{c(i.data.items)})),E()}));const H=(e,t)=>{let s=e[0],l=s.response[0];var r,o,a;u.marker([l.lat,l.long],{icon:i}).addTo(T).bindPopup(N(t,l)).openPopup(),r=l.lat,o=l.long,a=u.latLng(r,o),T.panTo(a),setTimeout((()=>{T.setView([r,o],15)}),500),setTimeout((()=>{s.active&&T.eachLayer((function(i){i.toGeoJSON&&T.removeLayer(i)}))}),500)};return o(v,{get children(){const i=D();return a(i,o(m,{className:"grid grid-cols-9 flex-1 gap-4",get children(){return[(()=>{const i=M(),t=i.firstChild,s=t.firstChild,l=s.firstChild;return i.addEventListener("submit",A),a(i,o(x,{label:"CHECK POS MSISDN"}),t),a(i,o(h,{loading:E,type:"number",placeholder:"MSISDN",get control(){return w.controls.search}}),t),a(t,o(x,{label:"HISTORY CHECK POST "}),s),a(l,(()=>{const i=n((()=>!!e()));return()=>i()?(()=>{const i=n((()=>0===e().length));return()=>i()?"Data Not Found":e()?.map(((i,t)=>(()=>{const t=O(),s=t.firstChild.firstChild,l=s.nextSibling;return l.firstChild,a(s,o(d,{onClick:()=>{let t=e().filter((e=>i._id===e._id));H(t,i.keyword,i.active),c((e=>e.map((e=>({...e,active:i._id===e._id&&!e.active})))))},get startIcon(){return o(j,{})},get children(){return i.keyword}})),a(l,(()=>b(i.timestamp).format("D/M/YY | HH:MM:SS")),null),t})()))})():"Loading..."})()),i})(),(()=>{const i=k();return a(i,o(x,{label:"LOCATION SOURCE"}),null),a(i,o(g,{title:"MAPS",className:"flex-1 !p-0 flex flex-col",get children(){const i=P(),e=i.firstChild.firstChild;return"function"==typeof y?p(y,e):y=e,i}}),null),i})()]}})),i}})};c(["click"]);export{E as default};
