import{b as e,H as t,u as r,l as a,n as l,d as i,i as s,m as o,B as d,P as n,j as c,s as p,h as m,t as u,S as f}from"./index-d44b4c22.js";import{C as v}from"./index-c66b90dd.js";import{C as x,A as g}from"./index-e8b17abd.js";import{C as b,T as h}from"./index-71d95980.js";import{C}from"./index-24a514f7.js";import{F as y}from"./FormControlLabel-3f4cf9c3.js";import{D as A}from"./input-3843779d.js";import{A as E}from"./AddAPhoto-4b573931.js";import{a as w}from"./avatar-0ae0561b.js";import{h as k}from"./moment-0b360bb8.js";import{c as _,a as j}from"./index.module-085e1610.js";import"./SwitchBase-26455d91.js";import"./formControlState-b6945e4c.js";import"./useControlled-15fabf1b.js";import"./Modal-3c0cb9cc.js";import"./Transition-839c2620.js";import"./isHostComponent-aa695ee2.js";import"./FormLabel-20daf39e.js";import"./Typography-f2013cfe.js";import"./index-1522cdc1.js";import"./FormControl-1561601a.js";import"./Visibility-0e2812d4.js";import"./CircularProgress-07fdfeec.js";const N=u('<img class="w-full h-full object-cover object-center ">'),R=u('<input class="opacity-0 w-full h-full absolute" accept="image/*" type="file">'),S=u('<div class="absolute p-2 top-0 right-0" title="Upload Your Picture">'),$=u('<div class="absolute top-0 h-full w-full left-0 px-4 overflow-auto">'),M=u('<div class=" flex flex-1 m-[-18px]"><div class="w-[350px] px-4 py-2 border-r-2 border-[#0A0A0A] flex flex-col"><div class="p-4 space-y-4"><div class="space-y-2"><div><div class="pl-[20px]"></div></div><div><div class="pl-[20px]"></div></div><div><div class="pl-[20px]"></div> </div><div><div class="pl-[20px]"></div></div></div></div></div><div class="flex-1 px-4 py-2 flex flex-col">'),D=u('<form class="py-6 flex flex-col flex-1" enctype="multipart/form-data">'),L=u('<div class="flex gap-4"><div class="flex gap-4 items-center"><div class="space-x-4">'),T=u('<div class="py-2"><div class="border border-primarry-2 px-4 bg-primarry-1 sticky top-[5px] z-50">'),F=u("<span>DATA DARI <b>"),I=u('<div><div class="flex gap-4 items-start flex-1 relative"><div> <!> </div><div class="flex-1 "><div class="gap-2 flex flex-wrap px-4"></div></div><div class="sticky top-[10px]"></div></div><div class="w-full flex justify-between items-center absolute bottom-[-5px] left-0"><div></div><div>'),O=u("<div>"),P=u('<div class="whitespace-nowrap max-w-xs relative"><div class="text-ellipsis overflow-hidden relative">'),V=u('<div><img class="w-20">'),B=()=>{const[u,B]=e([]),[U,q]=e(),[Y,H]=e(null),[K,z]=e(),G=_({profile_name:j("",{required:!0}),case_group:j("",{required:!0}),remarks:j("",{required:!0})}),Q=t(),J=r();let W=Q.pathname.split("/"),X=W[W.length-3];const Z=Q.pathname.split("/").pop(),[ee,te]=e(!1),[re,ae]=e({isError:!0,isErrorMsg:!1});a((()=>{l().get(`/deck-explorer/identification?keyword=${X}`).then((e=>{console.log(e),G.controls.profile_name.setValue(e.data.items.profile_name),G.controls.case_group.setValue(e.data.items.case_group),G.controls.remarks.setValue(e.data.items.remarks),H(e.data.items.foto_url),q(k(e.data.items.timestamp).format("D MMMM YYYY")),B(e.data.items.data)}))})),a((()=>{if(K()){var e=new FileReader;e.readAsDataURL(K()[0]),e.onloadend=function(){H((t=>({...t,label:e.result,type:"file"})))}}})),a((()=>{console.log(Y())}));a((()=>{var e=Z;var t;!/^[\s()+-]*([0-9][\s()+-]*){6,20}$/.test(e)&&e.length<0&&J("/"),(t=!0,u()?.reduce(((e,r)=>e+r.data.filter((e=>e.active===t)).length),0))>0?(ae((e=>({...e,isError:!1}))),ae((e=>({...e,isErrorMsg:!1})))):ae((e=>({...e,isError:!0}))),u().forEach((e=>{let t=e.data.reduce(((e,t)=>{let r=t.data.reduce(((e,t)=>(e.true+=t.active?1:0,e.false+=t.active?0:1,e.total+=t.id&&1,e)),{true:0,false:0,total:0});return e.true+=r.true,e.false+=r.false,e.total+=r.total,e}),{true:0,false:0,total:0});console.log(t),t.true>=0&&t.total!==t.true?te(!1):te(!0)}))}));const le=e=>{e.preventDefault();let t=u().map((e=>({...e,data:e.data.filter((e=>!1!==e.active))}))).filter((e=>e.data.length>0));const{case_group:r,profile_name:a,remarks:i}=G.value;let s=X,o={case_group:r,profile_name:a,remarks:i,keyword:s,data:t};const d=()=>{l().put("/deck-explorer/identification",o).then((e=>{f.fire({icon:"success",title:"INFO",text:e.data.message})}))};if(K()){const e=new FormData;e.append("file",K()[0]),l().post(`/deck-explorer/upload?keyword=${s}`,e,{headers:{"Content-Type":"application/x-www-form-urlencoded,"}}).then((e=>{d()}))}else d()};return i(v,{get children(){return[(()=>{const e=D();return e.addEventListener("submit",le),s(e,i(b,{get headerComponent(){return(()=>{const e=L(),t=e.firstChild,r=t.firstChild;return s(e,i(y,{label:"ADD ALL",onChange:e=>{let t=e.target.checked;te(!t),B((e=>e.map((e=>({...e,data:e.data.map((e=>({...e,active:!t,data:e.data.map((e=>({...e,active:!t})))})))})))))},get checked(){return ee()},get sx(){return{color:"dark"===o()?"#eee":"#444"}},get control(){return i(x,{sx:{borderRadius:0}})}}),t),s(r,i(d,{type:"submit",variant:"contained",color:"secondary",sx:{"&.Mui-disabled":{background:"#000",color:"#c0c0c0"}},children:"SAVE"}),null),s(r,i(d,{variant:"outlined",color:"error",onClick:()=>J(-1),children:"CANCEL"}),null),e})()},className:"!flex-1 flex !flex-col !p-4 min-h-[600px]",title:"EDIT",get children(){const e=M(),t=e.firstChild,r=t.firstChild,a=r.firstChild,l=a.firstChild,f=l.firstChild,v=l.nextSibling,g=v.firstChild,b=v.nextSibling,k=b.firstChild,_=b.nextSibling,j=_.firstChild,D=t.nextSibling;return s(r,i(n,{square:!0,elevation:2,class:"relative w-full h-[280px]",get children(){return[(()=>{const e=N();return c((()=>p(e,"src",Y()?.label?(Y(),Y().label):w))),e})(),(()=>{const e=S();return s(e,i(d,{variant:"contained",color:"secondary",sx:{borderRadius:0},get children(){return[i(E,{}),(()=>{const e=R();return e.addEventListener("change",(e=>{z(e.target.files),G.controls.foto.setValue(e.target.files)})),e})()]}})),e})()]}}),a),s(l,i(h,{className:"!py-0",label:"Original Name"}),f),s(f,i(A,{placeholder:"FIELD ORIGINAL NAME",removebg:!0,removeicon:!0,get control(){return G.controls.profile_name}})),s(v,i(h,{className:"!py-0",label:"CASE NUMBER"}),g),s(g,i(A,{placeholder:"FIELD CASE NUMBER",removebg:!0,removeicon:!0,get control(){return G.controls.case_group}})),s(b,i(h,{className:"!py-0",label:"REMARKS"}),k),s(k,i(A,{placeholder:"FIELD REMARKS",removebg:!0,removeicon:!0,get control(){return G.controls.remarks}})),s(_,i(h,{className:"!py-0",label:"DATE CREATED"}),j),s(j,U),s(D,i(h,{label:"MULTI SOURCE DATABASE INFORMATION"}),null),s(D,i(C,{title:"16 INFORMATION",className:"flex flex-col flex-1 relative",get children(){const e=$();return s(e,(()=>u().map((e=>(()=>{const t=T(),r=t.firstChild;return s(r,i(h,{get label(){return(()=>{const t=F(),r=t.firstChild.nextSibling;return s(r,(()=>e.label)),t})()}})),s(t,(()=>e.data.map((t=>(()=>{const r=I(),a=r.firstChild,l=a.firstChild,d=l.firstChild.nextSibling;d.nextSibling;const n=l.nextSibling,u=n.firstChild,f=n.nextSibling,v=a.nextSibling.firstChild,g=v.nextSibling;return s(l,(()=>1===t.total_data?"":`[${t.total_data}]`),d),s(l,(()=>t.label),null),s(u,(()=>t.data.map((t=>(()=>{const r=O();return s(r,i(y,{get class(){return`pl-4 !m-0 ${"dark"===o()?" "+(re().isErrorMsg?"border-red-500 text-red-500":"border-[#454545] bg-[#2C2C2C]"):re().isErrorMsg?"border-red-500 text-red-500":"bg-gray-200 text-[#444] border-[#aaa]"} pr-2 py-1 flex gap-4 border-[0] max-w-sm`},get checked(){return t.active},onChange:()=>{B((r=>r.map((r=>{if(r.id===e.id){const e=r.data.map((e=>{const r=e.data.map((e=>e.id===t.id?{...e,active:!e.active}:e)),a=r.every((e=>e.active));return{...e,active:a,data:r}}));return{...r,data:e}}return r}))))},get label(){return(()=>{const r=P(),a=r.firstChild;return s(a,(()=>{const r=m((()=>"FOTO"!==e.label));return()=>r()?t.label:(()=>{const e=V(),r=e.firstChild;return c((()=>p(r,"src",t.label))),e})()})()),r})()},labelPlacement:"start",get control(){return i(x,{})}})),c((()=>p(r,"title",t.label))),r})())))),s(f,i(x,{title:"Checked All",get checked(){return t.active},onChange:()=>{B((e=>e.map((e=>(console.log(e),{...e,data:e.data.map((e=>{if(t.id===e.id){const r=!t.active;return{...e,active:r,data:e.data.map((e=>({...e,active:r})))}}return e}))})))))}})),c((e=>{const t=`flex gap-4 relative border-b ${"dark"===o()?"border-[#333]":"border-[#aaa]"}  py-2 `,a=("dark"===o()?"text-[#aaa]":"text-[#444]")+" sticky top-[10px] whitespace-nowrap w-[200px] z-10 px-4 pt-2",i=`h-2 w-2 ${"dark"===o()?"bg-[#222222]":"bg-[#aaa]"} left-0`,s=`h-2 w-2 ${"dark"===o()?"bg-[#222222]":"bg-[#aaa]"} right-0`;return t!==e._v$&&(r.className=e._v$=t),a!==e._v$2&&(l.className=e._v$2=a),i!==e._v$3&&(v.className=e._v$3=i),s!==e._v$4&&(g.className=e._v$4=s),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),r})()))),null),t})())))),e}}),null),e}})),e})(),i(g,{description:"Please ensure all required fields are filled out.",title:"ALERT ERROR"})]}})};export{B as default};
